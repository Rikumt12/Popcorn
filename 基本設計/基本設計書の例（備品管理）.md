# 備品管理システム 基本設計書

| ドキュメントバージョン | 1.0                                    |
| :------------------- | :------------------------------------- |
| 作成日               | 2025年4月20日                           |
| 作成チーム           | チーム〇〇                               |
| 承認者               | 〇〇 〇〇様                              |
| 更新履歴             | 2025/04/20: Ver.1.0 初版作成 (チーム〇〇) |

---

## 1. はじめに

### 1.1. 本書の目的

本書は、A社が開発を進める「備品管理システム」新規構築プロジェクトにおける基本設計の内容を定義するものである。要件定義書で定められた要件に基づき、システムの全体構成、主要な機能、画面、データ、非機能要件への対応方針などを明確にし、後続の詳細設計、実装、テスト工程のインプットとすることを目的とする。

### 1.2. プロジェクト概要

社内の備品管理における台帳記入の手間、在庫数の不整合、補充漏れといった課題を解決し、管理業務の効率化と備品の適正な在庫管理を実現することを目的とする。

### 1.3. 前提知識

本書を読むにあたり、以下の知識を有していることを前提とする。

- 本プロジェクトの要件定義書の内容
- Webアプリケーション開発の基本的な知識 (HTTP, HTML, CSS, JavaScript)
- REST API の基本的な概念
- Java および Spring Boot フレームワークの基本的な知識
- リレーショナルデータベースの基本的な知識

## 2. システム概要

### 2.1. システムの目的

社内の備品管理における台帳記入の手間、在庫数の不整合、補充漏れといった課題を解決し、管理業務の効率化と備品の適正な在庫管理を実現することを目的とする。

### 2.2. 対象ユーザー

- **一般社員:** 備品を利用する社員
- **システム管理者（開発担当者）:** 備品情報の初期登録やデータメンテナンスを行う（管理画面は開発対象外）。

### 2.3. システム構成図

<div class="mermaid">
graph LR
    subgraph ユーザー環境
        A[クライアントPC<br>（ブラウザ: Chrome/Edge）] -- USB --> B(バーコードリーダー);
    end

    subgraph 社内ネットワーク/クラウド
        subgraph Web/APサーバー
           C[備品管理システム<br>（Web/APサーバー）]
        end
        subgraph DBサーバー
            D[データベースサーバー]
        end
        subgraph "ファイルサーバー (オプション)"
            E[CSVファイル置き場]
        end
         subgraph "認証サーバー (オプション)"
            F[Active Directory]
        end

        C --> D;
        C --> E;
        C <--> F;
    end

    A -- HTTPS --> C;

    style A fill:#lightyellow,stroke:#333,stroke-width:2px
    style C fill:#lightblue,stroke:#333,stroke-width:2px
    style D fill:#lightgreen,stroke:#333,stroke-width:2px
    style E fill:#lightgrey,stroke:#333,stroke-width:1px
    style F fill:#orange,stroke:#333,stroke-width:1px
</div>

- **クライアント**: 社員が利用するPC（Windows）。Webブラウザ（Chrome/Edge）からシステムへアクセス。USB接続のバーコードリーダーを利用。
- **サーバー**: 社内ネットワークまたはクラウド環境に構築。Web/APサーバー、DBサーバーで構成。ファイル取り込み用にファイルサーバー、認証用にActive Directoryと連携する可能性あり。
- **ネットワーク**: 社内LAN経由でHTTPS通信を行う。

### 2.4. 外部インターフェース概要

- **バーコードリーダー**: USB接続のバーコードリーダーをPCに接続し、キーボード入力として備品コードなどを画面に入力する。
- **CSVファイル**: 既存の備品リストの初期データ移行や、新規備品の一括登録のためにCSVファイルのアップロード/取り込み機能を持つ。
- **Active Directory**: ユーザー認証のために連携を行う場合がある。（オプション）
- (将来的に他システムとのAPI連携が必要な場合は別途定義)

## 3. 機能設計

### 3.1. 機能一覧

- **認証機能**
    - ログイン/ログアウト機能
    - (オプション) Active Directory連携によるシングルサインオン
- **備品管理機能**
    - 備品情報登録・編集・削除（論理削除）機能
    - 備品一覧表示・検索・絞り込み機能
    - 在庫数表示機能
    - 在庫閾値チェック機能
- **在庫操作機能**
    - 入庫登録機能（バーコード読取対応）
    - 出庫登録機能（バーコード読取対応）
    - 在庫履歴（入出庫履歴）記録・表示機能
- **マスター管理機能 (管理者向け)**
    - ユーザー管理機能（登録・編集・削除）
    - カテゴリーマスタ管理機能
    - 権限ロール管理機能
- **データ連携機能**
    - CSVファイルによる備品情報一括登録機能
    - (オプション) 在庫不足通知メール送信機能
- **レポート・その他機能 (管理者向け)**
    - (要件に応じて) 在庫レポート出力機能
    - (要件に応じて) 閾値設定機能

### 3.2. 機能構成図

<div class="mermaid">
graph TD
    A[備品管理システム] --> B(認証機能);
    A --> C(備品管理);
    A --> D(在庫操作);
    A --> E(マスター管理);
    A --> F(データ連携);
    A --> G(レポート・その他);

    subgraph C[備品管理]
        C1[登録・編集・削除]
        C2[一覧表示・検索]
        C3[在庫数表示]
        C4[在庫閾値チェック]
    end

    subgraph D[在庫操作]
        D1[入庫登録]
        D2[出庫登録]
        D3[在庫履歴管理]
    end

     subgraph E[マスター管理]
        E1[ユーザー管理]
        E2[カテゴリー管理]
        E3[権限ロール管理]
    end

     subgraph F[データ連携]
        F1[CSV一括登録]
        F2[メール通知]
    end

    B -- ログイン後 --> C;
    B -- ログイン後 --> D;
    B -- 管理者ログイン後 --> E;
    B -- ログイン後 --> F;
    B -- 管理者ログイン後 --> G;

    style A fill:#f9f,stroke:#333,stroke-width:2px
</div>

### 3.3. 主要機能フロー

システムで行われる代表的な業務フローを示す。

#### 3.3.1. 在庫不足フロー

<div class="mermaid">
sequenceDiagram
    participant システム as 備品管理システム
    participant 管理者 as 管理者(総務部)
    participant メール as メールサーバ

    loop 定期的な在庫チェック (例: 夜間バッチ)
        システム ->> システム: 定期的に在庫をチェック
    end

    alt 在庫が設定された閾値を下回る
        システム ->> メール: メール送信(要補充の備品通知)
        メール ->> 管理者: 通知メール受信
        管理者 ->> 管理者: (システム外) 備品の発注処理
        管理者 ->> システム: (商品到着後) システムで入庫処理を実行
        システム ->> システム: 在庫数を更新、入庫履歴を記録
    else 閾値以上
        システム ->> システム: 特に処理せず
    end
</div>

- システムはスケジュールされたタイミング（例：夜間バッチ）で各備品の在庫数をチェックする。
- 設定された最低在庫数（閾値）を下回った備品があれば、管理担当者へ通知メールを送信する。
- 管理者は通知を受け取り、必要に応じて備品を発注する（システム外のプロセス）。
- 発注した備品が納品されたら、管理者はシステム上で入庫処理を行い、在庫数を反映させる。

#### 3.3.2. 廃棄処理フロー

<div class="mermaid">
sequenceDiagram
    participant 管理者 as 管理者(総務部)
    participant システム as 備品管理システム

    管理者 ->> システム: 備品一覧画面から廃棄対象の備品を検索・選択
    システム ->> 管理者: 備品詳細画面または専用画面を表示
    管理者 ->> システム: 廃棄する数量を入力し、廃棄実行を指示
    システム ->> システム: 在庫数を減算し、出庫履歴(種別:廃棄)を記録
    alt 在庫数が0になった場合
        システム ->> システム: 備品マスタのステータスを「廃棄済み」等に変更 (または active_flagをOFFにして論理削除)
    end
    システム -->> 管理者: 廃棄処理完了メッセージを表示
</div>

- 管理者がシステム上で廃棄したい備品を検索・選択する。
- 廃棄する数量を入力し、処理を実行する。
- システムは対象備品の在庫数を減算し、その操作履歴（廃棄）を記録する。
- 在庫数が0になった場合、その備品が一覧で有効なものとして表示されないようにステータスを変更（論理削除）する。

## 4. 画面設計

本章では、想定している主要画面のレイアウトや画面間の遷移など、UI設計の概要を示す。

### 4.1. 画面一覧

- **SC0001: ログイン画面**
    - ユーザーIDとパスワードを入力し、システムにログインするための画面。
    - (オプション) SSO（Active Directory連携）を利用する場合は、認証サーバーへのリダイレクトまたは認証連携処理を行う。
- **SC0101: 備品一覧画面**
    - システムに登録されている備品を一覧表示する画面。検索バーやカテゴリー絞り込み、在庫数の表示などを配置。
    - 一般ユーザー／管理者問わず、基本的にはこの画面を起点に操作を行う。
- **SC0102: 備品詳細画面**
    - 選択した備品の詳細情報（名称、型番、在庫数、単価、カテゴリなど）を表示・編集する画面。
    - 管理者権限を持つユーザーのみ「編集」「削除（論理削除）」ボタンが表示される。
- **SC0201: 入庫・出庫画面**
    - バーコードリーダーで読み取った情報（備品コード）を元に備品を特定し、数量を入力して入庫/出庫処理を行う画面。
    - 出庫の場合は利用者のID（またはアカウント名）を自動的に紐づけ、履歴を登録。
- **SC9001: 管理者専用メニュー画面** (または備品一覧画面内に管理者用メニューを配置)
    - ユーザー管理、カテゴリーマスタ管理、レポート出力や閾値設定など、管理者向けの機能へのリンクを集約。
- **SC9101: ユーザー管理画面** (管理者向け)
- **SC9201: カテゴリーマスタ管理画面** (管理者向け)
- **SC9301: CSVアップロード画面** (管理者向け)
- (その他、必要に応じて画面を追加)

### 4.2. 画面遷移図

以下に、主要な画面遷移を示す。

<div class="mermaid">
graph TD
    A[SC0001: ログイン画面] -- ログイン成功 --> B(SC0101: 備品一覧画面);

    B -- 備品選択 --> C(SC0102: 備品詳細画面);
    C -- 編集 --> C;
    C -- 削除 --> B;
    C -- 一覧へ戻る --> B;

    B -- 入出庫ボタン --> D(SC0201: 入庫・出庫画面);
    D -- 処理完了 --> B;
    D -- キャンセル --> B;

    B -- 管理者メニュー --> E(SC9001: 管理者メニュー);
    E -- ユーザー管理 --> F[SC9101: ユーザー管理];
    F --> E;
    E -- カテゴリ管理 --> G[SC9201: カテゴリ管理];
    G --> E;
    E -- CSVアップロード --> H[SC9301: CSVアップロード];
    H --> E;
    E -- 備品一覧へ --> B;

    B -- ログアウト --> A;
    C -- ログアウト --> A;
    D -- ログアウト --> A;
    E -- ログアウト --> A;

    style A fill:#f9f,stroke:#333,stroke-width:1px
    style B fill:#ccf,stroke:#333,stroke-width:1px
    style C fill:#ccf,stroke:#333,stroke-width:1px
    style D fill:#ccf,stroke:#333,stroke-width:1px
    style E fill:#ffcc99,stroke:#333,stroke-width:1px,color:#000
    style F fill:#ffebcc,stroke:#333,stroke-width:1px,color:#000
    style G fill:#ffebcc,stroke:#333,stroke-width:1px,color:#000
    style H fill:#ffebcc,stroke:#333,stroke-width:1px,color:#000

</div>

- **ログイン画面(SC0001)** ：ログイン成功後、備品一覧画面(SC0101)へ遷移。
- **備品一覧画面(SC0101)** ：備品の検索、選択などの操作を行い、詳細画面(SC0102)・入出庫画面(SC0201)・管理者メニュー(SC9001)（管理者のみ）に遷移可能。ログアウトも可能。
- **管理者メニュー(SC9001)** ：ユーザー管理(SC9101)やCSVアップロード(SC9301)などの管理者専用機能画面へ遷移。

### 4.3. UI/UX基本方針

- **シンプルさ**: 直感的に操作できるよう、画面構成や操作手順はシンプルにする。
- **一貫性**: ボタンの配置、ラベルの命名規則、エラーメッセージの表示形式などをシステム全体で統一する。
- **視認性**: 文字サイズや色使いに配慮し、情報が読みやすく、重要な情報が目立つようにする。
- **効率性**: バーコードリーダーの活用や入力支援機能により、データ入力の手間を削減する。頻繁に行う操作は少ないステップで完了できるようにする。
- **フィードバック**: ユーザーの操作に対して、処理中であることや処理結果（成功、エラー）を明確に表示する。
- **レスポンシブ**: 主な利用はPCブラウザを想定するが、将来的なタブレット利用なども考慮し、極端に画面レイアウトが崩れない程度の配慮を行う。（完全なレスポンシブ対応は別途検討）

### 4.4. 主要画面のワイヤーフレーム

ここでは主要画面のワイヤーフレーム（骨組み）を簡易的に示す。最終的なUIデザイン（色味やフォント等）は別途デザインフェーズで検討・作成する。

#### 4.4.1. 備品一覧画面ワイヤーフレーム

```
+--------------------------------------------------------------------------+
| ヘッダー (システム名、ログインユーザー名、ログアウトボタン)                 |
+--------------------------------------------------------------------------+
| 検索エリア                                                               |
|   キーワード: [ テキスト入力ボックス        ] [検索ボタン]                  |
|   カテゴリ: [ プルダウンリスト (全カテゴリ/文房具/...) ]                   |
|   [管理者メニューボタン(管理者のみ表示)] [入出庫画面へボタン]             |
+--------------------------------------------------------------------------+
| 備品リスト表示エリア                                                       |
| +------------------------------------------------------------------------+ |
| | 備品名 ▲ | 型番        | カテゴリ    | 在庫数 ▼ | ステータス | 操作 | |
| +----------+-------------+-------------+---------+----------+------| |
| | ペンA    | P-001       | 文房具      | 10      | 在庫あり | [詳細] | |
| | ノートB  | N-002       | 文房具      | 2       | 要補充   | [詳細] | |
| | マウスC  | M-003       | PC周辺機器  | 5       | 在庫あり | [詳細] | |
| | ...      | ...         | ...         | ...     | ...      | ...  | |
| +----------+-------------+-------------+---------+----------+------| |
| | ページネーション ( 1 / 2 / 3 ... )                                    | |
+--------------------------------------------------------------------------+
| フッター (コピーライトなど)                                                |
+--------------------------------------------------------------------------+
```

- **検索バー**: 備品名の部分一致検索。Enterキー押下または検索ボタンクリックで一覧を絞り込み。
- **カテゴリーフィルター**: プルダウンでカテゴリを選択し、絞り込み。
- **備品リスト(テーブル)**: 備品名、型番、カテゴリ、現在庫数、ステータス（在庫あり／要補充など）を表示。列名クリックでソート可能。
- **操作**: 「詳細」リンククリックで備品詳細画面へ遷移。
- **ボタン**: 管理者用メニューや入出庫画面への導線を設ける。

#### 4.4.2. 入庫・出庫画面ワイヤーフレーム

```
+--------------------------------------------------------------------------+
| ヘッダー (システム名、ログインユーザー名、ログアウトボタン)                 |
+--------------------------------------------------------------------------+
| 入庫・出庫 操作エリア                                                     |
|   操作種別: (●) 入庫  ( ) 出庫                                           |
|   備品コード: [ テキスト入力ボックス (バーコード入力用) ]                |
|   ---------------------------------------------------------------------- |
|   備品名:   [ 読み取り後に表示 (例: ペンA) ]                            |
|   現在庫数: [ 読み取り後に表示 (例: 10) ]                             |
|   数量:     [ 数値入力ボックス (例: 5)  ]                               |
|   [ 実行ボタン ] [ クリアボタン ] [ 一覧へ戻るボタン ]                    |
+--------------------------------------------------------------------------+
| 処理結果メッセージエリア                                                  |
|   (例: 「ペンAを5個入庫しました。」)                                       |
+--------------------------------------------------------------------------+
| フッター (コピーライトなど)                                                |
+--------------------------------------------------------------------------+
```

- バーコード入力欄に自動でフォーカスが当たるようにする。バーコードリーダーで読み取ると備品コードが入力され、該当する備品情報（備品名、現在庫数）を表示。
- 操作種別（入庫／出庫）を選択し、数量を入力して「実行」ボタンを押すとDBを更新し、結果メッセージを表示。
- 「クリア」ボタンで入力内容を初期化。「一覧へ戻る」で備品一覧画面へ遷移。

### 4.5. 主要画面項目定義（例：備品一覧画面）

(ワイヤーフレームで定義した要素について、補足情報や入力形式などを記述します。ここでは備品一覧画面の例を記載。)

- **画面ID**: SC0101
- **画面名**: 備品一覧画面
- **表示項目・入力項目**:
    - **検索キーワード**
        - **要素**: テキスト入力ボックス
        - **入力形式**: 文字列
        - **桁数**: 最大50文字
        - **補足**: 備品名に対する部分一致検索を行う。
    - **カテゴリーフィルター**
        - **要素**: プルダウンリスト
        - **選択肢**: カテゴリーマスタに登録されている名称 + 「全カテゴリ」
        - **補足**: 選択されたカテゴリに属する備品のみ表示。「全カテゴリ」選択時は絞り込みなし。
    - **備品リストテーブル**
        - **列**: 備品名, 型番, カテゴリ, 在庫数, ステータス, 操作(詳細リンク)
        - **表示形式**: テーブル形式
        - **補足**: 在庫数が閾値を下回る場合は「ステータス」列に「要補充」等を表示。在庫数などでソート可能。ページネーションを実装。
    - **管理者メニューボタン**
        - **要素**: ボタン
        - **表示条件**: 管理者権限を持つユーザーでログイン時のみ表示。
        - **動作**: クリックすると管理者専用メニュー画面(SC9001)へ遷移。
    - **入出庫画面へボタン**
        - **要素**: ボタン
        - **動作**: クリックすると入庫・出庫画面(SC0201)へ遷移。

---

## 5. データ設計

本節では、システムにおける主なエンティティ間の関係と、主要なデータの流れの概要を示す。

### 5.1. 概念データモデル（ER図）

<div class="mermaid">
erDiagram
    USERS ||--o{ STOCK_TRANSACTIONS : "performs"
    USERS }o--|| ROLES : "has"
    ITEMS ||--o{ STOCK_TRANSACTIONS : "target of"
    ITEMS }o--|| CATEGORIES : "belongs to"

    USERS {
        string user_id PK "ユーザーID (社員番号等)"
        string user_name "氏名"
        string email "メールアドレス"
        string password "パスワード (ハッシュ化, AD連携時はNULL許容)"
        int role_id FK "ロールID"
        datetime created_at "登録日時"
        datetime updated_at "更新日時"
    }
    ROLES {
        int role_id PK "ロールID (1:管理者, 2:一般ユーザーなど)"
        string role_name "ロール名"
    }
    ITEMS {
        string item_code PK "備品コード (バーコードの値など)"
        string item_name "備品名"
        string description "備考・説明"
        int category_id FK "カテゴリID"
        int stock_quantity "現在在庫数"
        int alert_threshold "在庫閾値"
        decimal unit_price "単価 (参考値)"
        boolean active_flag "有効フラグ (true:有効, false:論理削除)"
        datetime created_at "登録日時"
        datetime updated_at "更新日時"
    }
    CATEGORIES {
        int category_id PK "カテゴリID"
        string category_name "カテゴリ名"
    }
    STOCK_TRANSACTIONS {
        int transaction_id PK "トランザクションID (自動採番)"
        string item_code FK "備品コード"
        string user_id FK "操作ユーザーID"
        string transaction_type "種別 ('IN':入庫, 'OUT':出庫, 'DISPOSE':廃棄, 'INIT':初期登録)"
        int change_quantity "変動数量 (入庫/初期登録時は正、出庫/廃棄時は負)"
        int quantity_after_transaction "処理後在庫数"
        datetime transaction_date "処理日時"
    }

</div>

- **エンティティ**: USERS(ユーザー), ROLES(役割), ITEMS(備品), CATEGORIES(カテゴリ), STOCK_TRANSACTIONS(在庫トランザクション履歴)
- **リレーション**:
    - ユーザーは役割を持つ (1対多、USERS -> ROLES)
    - ユーザーは在庫操作を行う (1対多、USERS -> STOCK_TRANSACTIONS)
    - 備品はカテゴリに属する (1対多、ITEMS -> CATEGORIES)
    - 備品は在庫操作の対象となる (1対多、ITEMS -> STOCK_TRANSACTIONS)

### 5.2. 主要テーブル概要

- **USERS (ユーザーテーブル)**
    - システムを利用するユーザー情報を保持。
    - ユーザーID（社員番号など）を主キーとする。
    - `role_id` で権限（管理者/一般ユーザー）を管理。
    - パスワードはハッシュ化して保存。Active Directory連携の場合はパスワード管理をADに委任し、本テーブルでは保持しない（またはNULL許容）ことも検討。
- **ROLES (ロールマスタ)**
    - 権限ロール（管理者、一般ユーザーなど）を定義するマスタテーブル。
- **ITEMS (備品マスタ)**
    - 管理対象の備品情報を保持する中心的なテーブル。
    - 備品コード（バーコードで読み取る値など）を主キーとする。
    - 現在の在庫数を `stock_quantity` で保持。この値は在庫トランザクション発生時に更新される。
    - 在庫不足アラートのための閾値を `alert_threshold` で保持。
    - `active_flag` を用いて論理削除を行う（削除された備品は通常の一覧には表示しない）。
- **CATEGORIES (カテゴリマスタ)**
    - 備品の分類（文房具、PC周辺機器など）を定義するマスタテーブル。
- **STOCK_TRANSACTIONS (在庫トランザクション履歴テーブル)**
    - 入庫、出庫、廃棄、初期登録などの在庫変動履歴を記録するテーブル。
    - どの備品(`item_code`)が、誰(`user_id`)によって、いつ(`transaction_date`)、どのような操作(`transaction_type`)で、どれだけ数量が変動(`change_quantity`)し、結果として在庫数がいくつになった(`quantity_after_transaction`)かを記録する。
    - 在庫数の整合性チェックや棚卸し時の確認に利用する。

### 5.3. データフロー概要

**例：備品入庫処理時のデータフロー**

1.  **画面(SC0201)**: ユーザーがバーコードリーダーで備品コードを読み取り、入庫数量を入力して「実行」ボタンをクリック。
2.  **アプリケーション(Backend)**:
    -   画面から備品コードと入庫数量、操作ユーザーIDを受け取る。
    -   `ITEMS`テーブルから該当する`item_code`の備品情報を検索。
    -   現在の`stock_quantity`に入庫数量を加算して、新しい在庫数を計算。
    -   `STOCK_TRANSACTIONS`テーブルに新しいレコードを挿入。(`transaction_type`='IN', `change_quantity`=入庫数量(正の値), `quantity_after_transaction`=計算後の在庫数, `user_id`=操作ユーザーID, `transaction_date`=現在日時)
    -   `ITEMS`テーブルの該当レコードの`stock_quantity`を計算後の在庫数で更新し、`updated_at`を更新。
3.  **データベース(DB)**: `ITEMS`テーブルの更新、`STOCK_TRANSACTIONS`テーブルへの挿入が行われる。
4.  **アプリケーション(Backend)**: 処理結果（成功）を画面に返す。
5.  **画面(SC0201)**: 処理完了メッセージを表示。

## 6. 非機能要件 対応方針

### 6.1. 性能

- **レスポンスタイム**: 主要画面（備品一覧表示、詳細表示、在庫操作実行）の応答時間は、通常時（同時接続10ユーザー程度）において3秒以内を目指す。
- **同時接続ユーザー数**: ピーク時（例: 月末の棚卸し時期など）に最大100ユーザー程度の同時利用を想定。
- **対応方針**:
    - データベースのテーブル設計において、検索パフォーマンスを考慮したインデックス（`ITEMS`テーブルの`item_code`, `item_name`, `category_id`、`STOCK_TRANSACTIONS`テーブルの`item_code`, `user_id`, `transaction_date`など）を適切に設定する。
    - 大量データ表示が想定される備品一覧画面では、ページネーションを実装し、一度に表示する件数を制限する。
    - アプリケーションサーバー、データベースサーバーのスペックは、負荷試験の結果に基づき適切なものを選定・調整する。（クラウド環境利用の場合はスケーリングも考慮）
    - (必要に応じて) キャッシュ機構の導入を検討。

### 6.2. セキュリティ

- **認証・認可**:
    - ログイン認証は、原則として社内Active Directoryと連携し、シングルサインオンを実現する方向で検討。AD連携が利用できないユーザー向けに、個別のID/パスワード認証機能も提供する。パスワードはハッシュ化（ソルト付き）して保存する。
    - ユーザーの役割（管理者/一般ユーザー）に応じて、利用可能な機能（マスタ管理、備品情報の編集・削除権限など）を制御する（認可）。
- **通信の暗号化**:
    - クライアント（ブラウザ）とWebサーバー間の通信は、全てHTTPS（TLS 1.2以上）を使用して暗号化する。証明書は、社内CAまたは信頼された第三者認証局（Let's Encrypt等）発行のものを使用する。
- **入力値の検証**:
    - 全てのユーザー入力値（検索キーワード、登録・編集データ、URLパラメータなど）に対して、サーバーサイドで適切なバリデーション（形式チェック、文字種チェック、長さチェックなど）を実施する。
    - SQLインジェクション対策（プレースホルダの使用、エスケープ処理）、クロスサイトスクリプティング（XSS）対策（入力値および出力時のエスケープ処理）を実装する。
- **アクセス制御**:
    - URL直接指定による不正な画面アクセスや機能実行を防ぐため、適切なアクセス権チェックをサーバーサイドで行う。
- **その他**:
    - セッション管理を適切に行い、セッションIDの推測や固定化（Session Fixation）を防止する。
    - 使用するフレームワークやライブラリのセキュリティ脆弱性情報を継続的に収集し、必要に応じてアップデートを行う。

### 6.3. 可用性

- **目標稼働率**: 業務時間内（平日9:00-18:00）において、99.5%以上の稼働率を目指す。（計画メンテナンス時間を除く）
- **対応方針**:
    - 初期リリース段階ではシングル構成を基本とするが、サーバー障害時の復旧手順（バックアップからのリストア、代替サーバーへの切り替え等）を確立する。
    - (オプション) リリース後の利用状況や重要度の高まりに応じて、Web/APサーバーの冗長化（負荷分散構成）、DBサーバーの冗長化（クラスタ構成、レプリケーション等、クラウドサービス利用の場合はマネージドサービスの高可用性オプション利用）を検討する。
    - 定期的なバックアップを実施し、障害発生時にデータを復旧できるようにする。（詳細は「7.3 バックアップ・リカバリ方針」参照）

### 6.4. その他（保守性、運用性、拡張性など）

- **保守性**:
    - コードの可読性を高めるため、コーディング規約を定め遵守する。
    - フレームワーク（例: Spring Boot, Laravel, Ruby on Railsなど）の標準的な設計パターン（MVC, Layered Architectureなど）に従い、責務分離を意識した実装を行う。
    - 設定値（DB接続情報、メールサーバー情報、閾値など）は設定ファイルや環境変数で管理し、コード内にハードコーディングしない。
- **運用性**:
    - システムの稼働状況やエラー発生を把握するためのログ出力を行う。（詳細は「7.1 ログ設計方針」参照）
    - 定期的なメンテナンス（OSアップデート、ライブラリアップデート）計画を立てる。
- **拡張性**:
    - 将来的な機能追加（他システム連携、モバイル対応など）を見据え、疎結合な設計を心がける。
    - マスターテーブル（ROLES, CATEGORIES）は、データ追加で対応可能な設計とする。

## 7. 運用・保守設計の概要

### 7.1. ログ設計方針

- **出力ログ**:
    - **アクセスログ**: Webサーバーレベルで記録（リクエスト日時、IPアドレス、メソッド、URL、ステータスコード、処理時間など）。
    - **アプリケーションログ**: アプリケーションの動作状況（起動・停止、主要な処理の開始・終了）、エラー発生時の詳細情報（スタックトレース、エラー内容）、デバッグ情報（必要に応じて）を出力。
    - **操作ログ（監査ログ）**: 重要な操作（ログイン成功/失敗、備品情報の登録・更新・削除、在庫操作、ユーザー管理操作など）について、「いつ」「誰が」「どのデータに対して」「何をしたか」を記録する。専用のテーブルまたはログファイルに出力。
- **ログレベル**: INFO, WARN, ERRORなどのログレベルを定義し、本番環境では通常INFO以上を出力。エラー発生時や調査時にはDEBUGレベルに変更可能にする。
- **ログフォーマット**: タイムスタンプ、ログレベル、メッセージ、(可能な範囲で)関連するユーザーIDやリクエストIDなど、解析に必要な情報を含める。
- **保管期間**: アクセスログ、アプリケーションログは最低1ヶ月、操作ログは最低1年間保管する方針とする。（法的要件や社内規定に応じて調整）

### 7.2. 監視設計方針

- **監視項目**:
    - **サーバーリソース監視**: CPU使用率、メモリ使用率、ディスクI/O、ディスク空き容量、ネットワークトラフィック。
    - **プロセス監視**: Webサーバー、APサーバー（アプリケーションプロセス）、DBサーバーのプロセス稼働状況。
    - **サービス監視**: WebアプリケーションへのHTTP/HTTPS応答確認（死活監視）。
    - **ログ監視**: アプリケーションログ中のエラー（ERRORレベル）発生検知。
    - (オプション) DBのパフォーマンス監視（スロークエリ検知など）。
- **監視方法**: 監視ツール（例: Zabbix, Nagios, Prometheus+Grafana, クラウドサービスの監視機能）を導入し、閾値超過や異常検知時に管理者に通知（メール、チャットツール等）する仕組みを構築する。

### 7.3. バックアップ・リカバリ方針

- **バックアップ対象**: データベース（全データ）、(必要であれば)アップロードされたファイル、アプリケーションの設定ファイル。
- **バックアップ方式**: データベースは日次でフルバックアップを取得。トランザクションログのバックアップも併用し、ポイントインタイムリカバリを可能にすることを検討。
- **バックアップ頻度**: 1日1回（例: 深夜）。
- **保管場所**: バックアップデータは、本番環境とは物理的に異なる場所（別サーバー、クラウドストレージ等）に保管する。
- **保管期間**: 直近7日分の日次バックアップ、加えて週次バックアップを4週間分、月次バックアップを6ヶ月分保管する方針とする。（要件に応じて調整）
- **リカバリ手順**: 障害発生時の復旧手順を文書化し、定期的にリストアテストを実施して手順の有効性を確認する。目標復旧時間（RTO）と目標復旧時点（RPO）を定める。

## 8. 制約事項・前提条件

### 8.1. 使用技術スタック

本システムの開発にあたり、以下の技術を使用することを前提とする。

- **言語**: (例: Java 17, PHP 8.1, Ruby 3.1)
- **フレームワーク**: (例: Spring Boot 3.x, Laravel 10.x, Ruby on Rails 7.x)
- **データベース**: (例: PostgreSQL 15, MySQL 8.0)
- **フロントエンド**: (例: HTML5, CSS3, JavaScript(ES6), Thymeleaf, Vue.js)
- **Webサーバー**: (例: Apache, Nginx)
- **その他ライブラリ**: (例: Apache POI (CSV/Excel操作), Lombok (Java))

### 8.2. インフラ環境

- **サーバーOS**: (例: Linux - Rocky Linux 9, Ubuntu 22.04 LTS)
- **実行環境**: (例: OpenJDK 17, PHP-FPM, Puma)
- **稼働場所**: (例: 社内オンプレミスサーバー, AWS EC2/RDS, Azure VM/Database)
- **ネットワーク**: 社内LAN環境からのアクセスを基本とする。

### 8.3. 開発・運用ルール

- **バージョン管理**: Gitを使用し、指定されたリポジトリ（例: GitLab, GitHub Enterprise）で管理する。ブランチ戦略（例: Git-flow）を定める。
- **コーディング規約**: プロジェクト標準のコーディング規約を定め、静的解析ツール（例: Checkstyle, ESLint, RuboCop）等でチェックを行う。
- **テスト**: 単体テスト、結合テスト、システムテストを実施する。テストコード作成に関するルールを定める。
- **デプロイ**: デプロイ手順を確立し、自動化を検討する。

### 8.4. スコープ外

- 実際のAPI仕様の細部（例：RESTエンドポイントやリクエスト/レスポンスのJSON構造詳細）
- 単体テスト、結合テストの項目一覧やテストケース詳細
- 詳細な運用保守手順書、障害対応手順書
- (その他、今回の開発範囲に含まれない機能や要件があれば明記)

### 8.5. その他前提条件

- システムはWebアプリケーションとして開発し、主に社内ネットワークから利用される。
- クライアントPCのWebブラウザは、Google Chrome および Microsoft Edge の最新安定版を対象とする。
- バーコードリーダーは、USB接続タイプで、キーボードインターフェースとして動作するもの（読み取り時に備品コード＋改行コードが出力されるなど）を想定する。リーダー固有のドライバインストールが不要なものを推奨。
- 初期データ移行用のCSVファイルは、指定されたフォーマットで提供されるものとする。

## 9. （付録）用語集・略語リスト

(プロジェクト内で使用される専門用語や略語があれば定義します。)
- **AD**: Active Directory
- **CSV**: Comma Separated Values
- **DB**: Database
- **ER図**: Entity-Relationship Diagram
- **HTTPS**: Hypertext Transfer Protocol Secure
- **SSO**: Single Sign-On
- **UI**: User Interface
- **UX**: User Experience
- ...

## 10. 承認

本基本設計書の内容を、以下の関係者が承認する。後続フェーズでの設計変更が発生した場合、変更管理のプロセスに従い本書を改訂し、バージョン管理を行う。

| 承認者        | 所属・役職          | 日付         | 印 |
| :------------ | :------------------ | :----------- | :- |
| ○○ ○○ (甲)   | A社 システム企画部  | 202X/XX/XX   |    |
| △△ △△ (甲)   | A社 総務部 部長     | 202X/XX/XX   |    |
| □□ □□ (乙)   | 株式会社ベンダー    | 202X/XX/XX   |    |
